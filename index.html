<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fuel Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);
      margin: 0;
      padding: 0;
    }
    header {
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      text-align: center;
      padding: 1rem;
    }
    .container {
      max-width: 900px;
      margin: 2rem auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      padding: 2rem;
    }
    h2 {
      margin-top: 0;
    }
    form input, form button {
      padding: 0.5rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    form button {
      background: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    form button:hover {
      transform: scale(1.05);
      background: #45a049;
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    .card {
      background: #f4f4f9;
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }
    .records ul {
      list-style: none;
      padding: 0;
    }
    .records li {
      background: #fafafa;
      margin: 0.5rem 0;
      padding: 0.7rem;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      opacity: 0;
      transform: translateY(10px);
      animation: fadeSlideIn 0.5s forwards;
    }
    @keyframes fadeSlideIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .btn-small {
      padding: 0.3rem 0.6rem;
      margin-left: 0.5rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn-edit { background: #2196F3; color: #fff; }
    .btn-edit:hover { background: #0b7dda; }
    .btn-delete { background: #f44336; color: #fff; }
    .btn-delete:hover { background: #da190b; }
    .btn-export { background: #ff9800; color: #fff; }
    .btn-export:hover { background: #e68a00; }
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #4caf50;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      opacity: 0;
      transition: opacity 0.5s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .toast.show { opacity: 1; }
    .settings-panel {
      margin-top: 2rem;
      padding: 1rem;
      background: #f9f9f9;
      border-radius: 8px;
      display: none;
    }
    .monthly-summary {
      margin-top: 2rem;
    }
    .monthly-summary table {
      width: 100%;
      border-collapse: collapse;
    }
    .monthly-summary th, .monthly-summary td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    .monthly-summary th {
      background: #eee;
    }
  </style>
</head>
<body>
  <header>
    <h1>‚õΩ Fuel Tracker</h1>
  </header>
  <div class="container">
    <h2>Add Entry</h2>
    <form id="fuelForm">
      <input type="date" id="date" required>
      <input type="number" id="distance" placeholder="Distance (km)" required>
      <input type="number" id="fuel" placeholder="Fuel (liters)" required>
      <input type="number" id="cost" placeholder="Cost (‚Çπ)" required>
      <input type="number" id="efficiency" placeholder="Preferred Mileage (km/l)" required>
      <button type="submit">Add Entry</button>
    </form>

    <div class="stats">
      <div class="card">
        <h3>Total Distance</h3>
        <p id="totalDistanceStat">0 km</p>
      </div>
      <div class="card">
        <h3>Total Fuel</h3>
        <p id="totalFuel">0 L</p>
      </div>
      <div class="card">
        <h3>Total Cost</h3>
        <p id="totalCost">‚Çπ0</p>
      </div>
      <div class="card">
        <h3>Actual Mileage</h3>
        <p id="actualMileage">0 km/l</p>
      </div>
    </div>

    <h2>Records</h2>
    <div class="records">
      <ul id="recordList"></ul>
    </div>

    <button class="btn-small btn-export" onclick="exportCSV()">üì• Export CSV</button>

    <div class="monthly-summary">
      <h2>Monthly Summary</h2>
      <div id="monthlySummary"></div>
    </div>

    <button onclick="toggleSettings()">‚öôÔ∏è Settings</button>
    <div class="settings-panel" id="settingsPanel">
      <button class="btn-small btn-delete" onclick="resetApp()">Reset App</button>
    </div>
  </div>
  <div class="toast" id="toast">Saved successfully!</div>

  <script>
    let records = JSON.parse(localStorage.getItem('records')) || [];
    let editingIndex = null;

    document.getElementById('fuelForm').addEventListener('submit', function(e){
      e.preventDefault();
      const date = document.getElementById('date').value;
      const distance = parseFloat(document.getElementById('distance').value);
      const fuel = parseFloat(document.getElementById('fuel').value);
      const cost = parseFloat(document.getElementById('cost').value);
      const efficiency = parseFloat(document.getElementById('efficiency').value);

      const entry = {date, distance, fuel, cost, efficiency};

      if(editingIndex !== null){
        records[editingIndex] = entry;
        editingIndex = null;
        showToast('Entry updated ‚úÖ');
      } else {
        records.push(entry);
        showToast('Entry added ‚úÖ');
      }

      localStorage.setItem('records', JSON.stringify(records));
      renderRecords();
      this.reset();
    });

    function renderRecords(){
      const list = document.getElementById('recordList');
      list.innerHTML = '';
      let totalDist = 0, totalFuel = 0, totalCost = 0;

      records.forEach((r, i) => {
        totalDist += r.distance;
        totalFuel += r.fuel;
        totalCost += r.cost;

        const li = document.createElement('li');
        li.innerHTML = `${r.date} - ${r.distance} km, ${r.fuel} L, ‚Çπ${r.cost}
          <span>
            <button class="btn-small btn-edit" onclick="editRecord(${i})">Edit</button>
            <button class="btn-small btn-delete" onclick="deleteRecord(${i})">Delete</button>
          </span>`;
        list.appendChild(li);
      });

      document.getElementById('totalDistanceStat').innerText = totalDist + ' km';
      document.getElementById('totalFuel').innerText = totalFuel + ' L';
      document.getElementById('totalCost').innerText = '‚Çπ' + totalCost;
      document.getElementById('actualMileage').innerText = totalFuel > 0 ? (totalDist/totalFuel).toFixed(2) + ' km/l' : '0 km/l';

      renderMonthlySummary();
    }

    function editRecord(i){
      const r = records[i];
      document.getElementById('date').value = r.date;
      document.getElementById('distance').value = r.distance;
      document.getElementById('fuel').value = r.fuel;
      document.getElementById('cost').value = r.cost;
      document.getElementById('efficiency').value = r.efficiency;
      editingIndex = i;
    }

    function deleteRecord(i){
      records.splice(i, 1);
      localStorage.setItem('records', JSON.stringify(records));
      renderRecords();
      showToast('Entry deleted üóëÔ∏è');
    }

    function exportCSV(){
      let csv = 'Date,Distance,Fuel,Cost,Efficiency\\n';
      records.forEach(r => {
        csv += `${r.date},${r.distance},${r.fuel},${r.cost},${r.efficiency}\\n`;
      });
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'fuel_records.csv';
      a.click();
      URL.revokeObjectURL(url);
    }

    function renderMonthlySummary(){
      const summaryDiv = document.getElementById('monthlySummary');
      summaryDiv.innerHTML = '';
      const summary = {};

      records.forEach(r => {
        const month = r.date.slice(0,7);
        if(!summary[month]) summary[month] = {dist:0,fuel:0,cost:0};
        summary[month].dist += r.distance;
        summary[month].fuel += r.fuel;
        summary[month].cost += r.cost;
      });

      let html = '<table><tr><th>Month</th><th>Total Distance</th><th>Total Fuel</th><th>Total Cost</th><th>Avg Mileage</th></tr>';
      for(const m in summary){
        const s = summary[m];
        html += `<tr><td>${m}</td><td>${s.dist}</td><td>${s.fuel}</td><td>‚Çπ${s.cost}</td><td>${(s.dist/s.fuel).toFixed(2)} km/l</td></tr>`;
      }
      html += '</table>';
      summaryDiv.innerHTML = html;
    }

    function showToast(msg){
      const toast = document.getElementById('toast');
      toast.innerText = msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'),2000);
    }

    function toggleSettings(){
      const panel = document.getElementById('settingsPanel');
      panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
    }

    function resetApp(){
      if(confirm('Are you sure you want to reset the app? This will delete all records.')){
        records = [];
        localStorage.removeItem('records');
        renderRecords();
        showToast('App reset üóëÔ∏è');
      }
    }

    renderRecords();
  </script>
</body>
</html>
